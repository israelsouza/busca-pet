CREATE TABLE ESTADO (
    EST_ID          NUMBER	GENERATED BY DEFAULT AS IDENTITY        PRIMARY KEY,
    EST_SIGLA       CHAR(2)     NOT NULL
)

CREATE TABLE CIDADE (
    CID_ID          NUMBER	GENERATED BY DEFAULT AS IDENTITY        PRIMARY KEY,
    CID_DESCRICAO   VARCHAR(35) NOT NULL,

    EST_ID          NUMBER,
    FOREIGN KEY (EST_ID) REFERENCES ESTADO(EST_ID)
)

CREATE TABLE ENDERECO (
    END_ID          NUMBER	GENERATED BY DEFAULT AS IDENTITY        PRIMARY KEY,
    END_RUA         VARCHAR(120) NOT NULL, 
    END_BAIRRO      VARCHAR(120) NOT NULL, 
    END_CEP         CHAR(8) NOT NULL, 

    CID_ID          NUMBER,
    FOREIGN KEY (CID_ID) REFERENCES CIDADE(CID_ID)
)

CREATE TABLE PESSOA (
    PES_ID          NUMBER	GENERATED BY DEFAULT AS IDENTITY        PRIMARY KEY,
    PES_NOME        VARCHAR(70) NOT NULL,
    PES_PHONE       CHAR(11) NOT NULL,

    CONSTRAINT UK_PES_PHONE UNIQUE (PES_PHONE),

    END_ID          NUMBER,
    FOREIGN KEY (END_ID) REFERENCES ENDERECO(END_ID)
);


CREATE TABLE USUARIO (
    USU_ID          NUMBER	GENERATED BY DEFAULT AS IDENTITY        PRIMARY KEY,    
    USU_EMAIL       VARCHAR(70) NOT NULL,
    USU_SENHA       VARCHAR(30) NOT NULL,
    USU_FOTO        BLOB,

    PES_ID          NUMBER,
    FOREIGN KEY (PES_ID) REFERENCES PESSOA(PES_ID),

    CONSTRAINT UK_USU_EMAIL UNIQUE (USU_EMAIL)
)


ALTER TABLE USUARIO
ADD USU_FOTO BLOB;

CREATE TABLE RECUPERAR_SENHA(
    REC_TOKEN       VARCHAR2(255) PRIMARY KEY,
    REC_DTLIMITE DATE NOT NULL,
    
    USU_ID          NUMBER,
    FOREIGN KEY (USU_ID) REFERENCES USUARIO(USU_ID)    
);


CREATE TABLE PET (
    PET_ID          NUMBER	GENERATED BY DEFAULT AS IDENTITY        PRIMARY KEY, 
    PET_TIPO        VARCHAR2(25) NOT NULL, --
    PET_DESCRICAO   VARCHAR(150) NOT NULL,
--    PET_LOCAL       VARCHAR(100) NOT NULL, -- AINDA NAO ADD, VAI SER ARMAZENADO COM A GEO LOCALIZACAO DO MAPS
    PET_FOTO        BLOB NOT NULL,
    PET_NOME        VARCHAR(70) NOT NULL,
    PET_RGA         VARCHAR(70),
    PET_DATA        DATE NOT NULL
)

ALTER TABLE PET
ADD PET_LOCAL VARCHAR(100);

CREATE TABLE POST (
    POS_ID          NUMBER	GENERATED BY DEFAULT AS IDENTITY        PRIMARY KEY,               
    POS_TIPO        VARCHAR(15) NOT NULL,    
    POS_DATA        DATE NOT NULL,

    PET_ID          NUMBER,
    FOREIGN KEY (PET_ID) REFERENCES PET(PET_ID),

    USU_ID          NUMBER,
    FOREIGN KEY (USU_ID) REFERENCES USUARIO(USU_ID)
)

CREATE TABLE PESSOA (
    PES_ID          NUMBER	GENERATED BY DEFAULT AS IDENTITY        PRIMARY KEY,
    PES_NOME        VARCHAR(70) NOT NULL,
    PES_PHONE       CHAR(11) NOT NULL,

    CONSTRAINT UK_PES_PHONE UNIQUE (PES_PHONE)
)



-- inserts estados
(
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('AC');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('AL');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('AP');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('AM');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('BA');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('CE');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('DF');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('ES');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('GO');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('MA');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('MT');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('MS');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('MG');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('PA');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('PB');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('PR');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('PE');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('PI');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('RJ');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('RN');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('RS');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('RO');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('RR');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('SC');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('SP');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('SE');
    INSERT INTO ESTADO (EST_SIGLA) VALUES ('TO');
)